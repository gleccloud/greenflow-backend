[0;34mâ„¹ï¸  === GreenFlow ìŠ¤í…Œì´ì§• ë°°í¬ ì‹œì‘ ===[0m
[0;34mâ„¹ï¸  1ë‹¨ê³„: í™˜ê²½ ê²€ì¦...
[0m
[0;32mâœ… git ì„¤ì¹˜ë¨ (git version 2.39.5 (Apple Git-154))[0m
[0;32mâœ… docker ì„¤ì¹˜ë¨ (Docker version 28.3.2, build 578ccf6)[0m
[0;32mâœ… npm ì„¤ì¹˜ë¨ (10.2.3)[0m
[0;32mâœ… node ì„¤ì¹˜ë¨ (v18.19.0)[0m
[0;32mâœ… .env.staging íŒŒì¼ í™•ì¸[0m
[0;34mâ„¹ï¸  
2ë‹¨ê³„: ì½”ë“œ ë¹Œë“œ...
[0m
[0;34mâ„¹ï¸  ë°±ì—”ë“œ ë¹Œë“œ ì¤‘...[0m
npm WARN deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm WARN deprecated npmlog@5.0.1: This package is no longer supported.
npm WARN deprecated supertest@6.3.4: Please upgrade to supertest v7.1.3+, see release notes at https://github.com/forwardemail/supertest/releases/tag/v7.1.3 - maintenance is supported by Forward Email @ https://forwardemail.net
npm WARN deprecated @humanwhocodes/config-array@0.13.0: Use @eslint/config-array instead
npm WARN deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
npm WARN deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
npm WARN deprecated are-we-there-yet@2.0.0: This package is no longer supported.
npm WARN deprecated @humanwhocodes/object-schema@2.0.3: Use @eslint/object-schema instead
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@7.2.3: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated gauge@3.0.2: This package is no longer supported.
npm WARN deprecated tar@6.2.1: Old versions of tar are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated superagent@8.1.2: Please upgrade to superagent v10.2.2+, see release notes at https://github.com/forwardemail/superagent/releases/tag/v10.2.2 - maintenance is supported by Forward Email @ https://forwardemail.net
npm WARN deprecated glob@10.4.5: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated glob@10.5.0: Old versions of glob are not supported, and contain widely publicized security vulnerabilities, which have been fixed in the current version. Please update. Support for old versions may be purchased (at exorbitant rates) by contacting i@izs.me
npm WARN deprecated eslint@8.57.1: This version is no longer supported. Please see https://eslint.org/version-support for other options.

added 939 packages, and audited 940 packages in 8s

157 packages are looking for funding
  run `npm fund` for details

16 vulnerabilities (4 low, 4 moderate, 8 high)

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.

> glec-api-backend@1.0.0 prebuild
> rimraf dist


> glec-api-backend@1.0.0 build
> nest build

[0;32mâœ… ë°±ì—”ë“œ ë¹Œë“œ ì™„ë£Œ[0m
[0;34mâ„¹ï¸  í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì¤‘...[0m
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: '@vitejs/plugin-react@5.1.2',
npm WARN EBADENGINE   required: { node: '^20.19.0 || >=22.12.0' },
npm WARN EBADENGINE   current: { node: 'v18.19.0', npm: '10.2.3' }
npm WARN EBADENGINE }
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: 'react-router@7.13.0',
npm WARN EBADENGINE   required: { node: '>=20.0.0' },
npm WARN EBADENGINE   current: { node: 'v18.19.0', npm: '10.2.3' }
npm WARN EBADENGINE }
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: 'react-router-dom@7.13.0',
npm WARN EBADENGINE   required: { node: '>=20.0.0' },
npm WARN EBADENGINE   current: { node: 'v18.19.0', npm: '10.2.3' }
npm WARN EBADENGINE }
npm WARN EBADENGINE Unsupported engine {
npm WARN EBADENGINE   package: 'vite@7.3.1',
npm WARN EBADENGINE   required: { node: '^20.19.0 || >=22.12.0' },
npm WARN EBADENGINE   current: { node: 'v18.19.0', npm: '10.2.3' }
npm WARN EBADENGINE }

added 289 packages, and audited 290 packages in 4s

66 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

> green-logistics-landing@0.0.0 build
> tsc -b && vite build

You are using Node.js 18.19.0. Vite requires Node.js version 20.19+ or 22.12+. Please upgrade your Node.js version.
vite v7.3.1 building client environment for production...
transforming...
âœ“ 2396 modules transformed.
rendering chunks...
computing gzip size...
dist/index.html                   0.47 kB â”‚ gzip:   0.30 kB
dist/assets/index-BZC_bn5Z.css   34.56 kB â”‚ gzip:   6.10 kB
dist/assets/index-9B7_RZhl.js   775.37 kB â”‚ gzip: 231.05 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
âœ“ built in 2.17s
[0;32mâœ… í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì™„ë£Œ[0m
[0;34mâ„¹ï¸  
3ë‹¨ê³„: Docker ì´ë¯¸ì§€ ìƒì„±...
[0m
[0;34mâ„¹ï¸  ë°±ì—”ë“œ Docker ì´ë¯¸ì§€ ë¹Œë“œ ì¤‘...[0m
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 804B done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/node:18-alpine
#2 DONE 0.8s

#3 [internal] load .dockerignore
#3 transferring context: 2B done
#3 DONE 0.0s

#4 [builder 1/6] FROM docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e
#4 resolve docker.io/library/node:18-alpine@sha256:8d6421d663b4c28fd3ebc498332f249011d118945588d0a35cb9bc4b8ca09d9e done
#4 DONE 0.0s

#5 [internal] load build context
#5 transferring context: 243.09MB 4.4s done
#5 DONE 4.4s

#6 [stage-1 4/5] RUN npm ci --omit=dev
#6 CACHED

#7 [builder 4/6] RUN npm ci
#7 CACHED

#8 [builder 5/6] COPY . .
#8 CACHED

#9 [builder 6/6] RUN npm run build
#9 CACHED

#10 [builder 2/6] WORKDIR /app
#10 CACHED

#11 [builder 3/6] COPY package*.json ./
#11 CACHED

#12 [stage-1 5/5] COPY --from=builder /app/dist ./dist
#12 CACHED

#13 exporting to image
#13 exporting layers done
#13 exporting manifest sha256:b1d320c09f27d44d4512d26722f41959ad0bb2f47810c7a154b739d0aeb3c622 done
#13 exporting config sha256:6c0104f2141d234556a9b63ae0ec7e51de4c913453cf48736a2457b83f721713 done
#13 exporting attestation manifest sha256:6304f4906c753e826db722b6249a7911c2085ed65d5cd3d1385eb80dcbdfc48d 0.0s done
#13 exporting manifest list sha256:75f7d14c6acec3fbd4ee8990cf1b4acce65454ca2b5c65ef5e2c1d397decbbb6 done
#13 naming to docker.io/library/glec-api:staging done
#13 unpacking to docker.io/library/glec-api:staging done
#13 DONE 0.1s

View build details: docker-desktop://dashboard/build/desktop-linux/desktop-linux/yspz4bbepkgfnl23gaf1xdl50
[0;32mâœ… ë°±ì—”ë“œ ì´ë¯¸ì§€ ì™„ë£Œ: glec-api:staging[0m
[0;34mâ„¹ï¸  í”„ë¡ íŠ¸ì—”ë“œ Docker ì´ë¯¸ì§€ ë¹Œë“œ ì¤‘...[0m
#0 building with "desktop-linux" instance using docker driver

#1 [internal] load build definition from Dockerfile
#1 transferring dockerfile: 1.34kB done
#1 DONE 0.0s

#2 [internal] load metadata for docker.io/library/nginx:alpine
#2 DONE 0.0s

#3 [internal] load metadata for docker.io/library/node:20-alpine
#3 DONE 0.6s

#4 [internal] load .dockerignore
#4 transferring context: 167B done
#4 DONE 0.0s

#5 [stage-1 1/3] FROM docker.io/library/nginx:alpine@sha256:42a516af16b852e33b7682d5ef8acbd5d13fe08fecadc7ed98605ba5e3b26ab8
#5 resolve docker.io/library/nginx:alpine@sha256:42a516af16b852e33b7682d5ef8acbd5d13fe08fecadc7ed98605ba5e3b26ab8 0.0s done
#5 DONE 0.0s

#6 [builder 1/6] FROM docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8
#6 resolve docker.io/library/node:20-alpine@sha256:09e2b3d9726018aecf269bd35325f46bf75046a643a66d28360ec71132750ec8 0.0s done
#6 DONE 0.0s

#7 [internal] load build context
#7 transferring context: 6.03kB done
#7 DONE 0.0s

#8 [builder 3/6] COPY package.json ./
#8 CACHED

#9 [builder 2/6] WORKDIR /app
#9 CACHED

#10 [builder 4/6] RUN npm install --include=dev --no-fund --no-audit 2>&1 || npm install --no-fund --no-audit
#10 CACHED

#11 [stage-1 2/3] COPY --from=builder /app/dist /usr/share/nginx/html
#11 CACHED

#12 [builder 5/6] COPY . .
#12 CACHED

#13 [builder 6/6] RUN npm run build
#13 CACHED

#14 [stage-1 3/3] RUN echo 'server {  listen 5173;  location / {    root /usr/share/nginx/html;    index index.html index.htm;    try_files $uri $uri/ /index.html;  }  location ~* \\.(?:js|css|png|jpg|jpeg|gif|ico|woff|woff2|ttf|svg)$ {    expires 30d;    add_header Cache-Control "public, immutable";  }}' > /etc/nginx/conf.d/default.conf
#14 CACHED

#15 exporting to image
#15 exporting layers done
#15 exporting manifest sha256:733e109b5d8310c379df02ab944adc3e3cd7869822597944cd41c15e34946164 done
#15 exporting config sha256:c5ec62283b722ff2f90a7ca0aaa18123fe1657769c9d8ad698cf4bc37f013df1 done
#15 exporting attestation manifest sha256:c53206f4d01f5ef0508dee05699163a6a5186391ae0d02a895961679a6a35128 done
#15 exporting manifest list sha256:7dce23ae3c67d02ace817711064df359b9962caeb808b95452c0d91c50617c22 done
#15 naming to docker.io/library/greenflow-frontend:staging done
#15 unpacking to docker.io/library/greenflow-frontend:staging done
#15 DONE 0.0s

View build details: docker-desktop://dashboard/build/desktop-linux/desktop-linux/rjqlgmqjawauemkd7h723hrg2
[0;32mâœ… í”„ë¡ íŠ¸ì—”ë“œ ì´ë¯¸ì§€ ì™„ë£Œ: greenflow-frontend:staging[0m
[0;34mâ„¹ï¸  
4ë‹¨ê³„: ë¡œì»¬ í†µí•© í…ŒìŠ¤íŠ¸...
[0m

[1;33mâš ï¸  ë¡œì»¬ í…ŒìŠ¤íŠ¸ ìŠ¤í‚µ[0m
[0;34mâ„¹ï¸  
5ë‹¨ê³„: ìŠ¤í…Œì´ì§• ë°°í¬ ì¤€ë¹„ ì•ˆë‚´...
[0m
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       ìŠ¤í…Œì´ì§• ë°°í¬ë¥¼ ìœ„í•œ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•˜ì„¸ìš”        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€í”„ë¡ íŠ¸ì—”ë“œ ë°°í¬ (Vercel)ã€‘
  1. Vercel í”„ë¡œì íŠ¸ ìƒì„±: vercel link --confirm
  2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •:
     - VITE_API_BASE_URL=https://staging-api.greenflow.dev/api/v2
     - VITE_GA_MEASUREMENT_ID=G-STAGING_ID
  3. ë°°í¬: vercel deploy --prod

ã€ë°±ì—”ë“œ ë°°í¬ (AWS ECS)ã€‘

  â–¶ ECR ì´ë¯¸ì§€ í‘¸ì‹œ:
    aws ecr get-login-password --region us-east-1 | \
    docker login --username AWS --password-stdin ACCOUNT_ID.dkr.ecr.us-east-1.amazonaws.com

    docker tag glec-api:staging ACCOUNT_ID.dkr.ecr.us-east-1.amazonaws.com/glec-api:staging
    docker push ACCOUNT_ID.dkr.ecr.us-east-1.amazonaws.com/glec-api:staging

  â–¶ ECS ì„œë¹„ìŠ¤ ë°°í¬:
    aws ecs update-service \
      --cluster greenflow-staging \
      --service greenflow-api \
      --force-new-deployment

ã€ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •ã€‘
  1. RDS PostgreSQL ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
  2. ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰: npm run db:migrate --env=staging
  3. ì‹œë“œ ë°ì´í„° ë¡œë“œ: npm run db:seed:staging

ã€ë„ë©”ì¸ & SSLã€‘
  1. Route53 DNS ë ˆì½”ë“œ ìƒì„±
  2. AWS Certificate Managerì—ì„œ SSL ì¸ì¦ì„œ ë°œê¸‰
  3. Application Load Balancerì— ì¸ì¦ì„œ ì—°ê²°

ã€ë°°í¬ ê²€ì¦ã€‘
  1. í”„ë¡ íŠ¸ì—”ë“œ ì ‘ê·¼: https://staging.greenflow.dev
  2. API í—¬ìŠ¤ ì²´í¬: curl https://staging-api.greenflow.dev/api/v2/health
  3. í†µí•© í…ŒìŠ¤íŠ¸: BASE_URL=https://staging.greenflow.dev npm run test:e2e:deployment

ã€ëª¨ë‹ˆí„°ë§ã€‘
  1. Sentry í”„ë¡œì íŠ¸ ìƒì„± ë° DSN ì„¤ì •
  2. Google Analytics ì¶”ì  ì½”ë“œ í™•ì¸
  3. CloudWatch ëŒ€ì‹œë³´ë“œ ìƒì„±

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“– ìì„¸í•œ ê°€ì´ë“œ: STAGING_DEPLOYMENT_CHECKLIST.md ì°¸ì¡°

[0;32mâœ… 
âœ¨ ìŠ¤í…Œì´ì§• ë°°í¬ ì¤€ë¹„ ì™„ë£Œ![0m

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ğŸ“Š ìƒì„±ëœ Docker ì´ë¯¸ì§€:
